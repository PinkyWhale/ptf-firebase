<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Firebase Stock-Database</title>
	<script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
	<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
	<script src="js/config.js"></script>
	<style>
	ul {
		list-style: none;
	}
	img {
		width: 150px;
		height: auto;
	}
	.productos {
		width: 1130px;
		margin: auto;
	}
	li {
		display: inline-block;
	}
	.prod div {
		width: 300px;
		margin: 20px;
		border-color: 1px solid black;
		text-align: left;
	}
	</style>
	<script>
		$(function(){

			// Cuando se encuentra un nuevo registro en "/productos/"
			firebase.database().ref('/productos/').on('child_added', function(data) {
				var producto = data.val().producto // Obtenemos el dato en la key producto
				var cantidad = data.val().cantidad // Obtenemos el dato en la key cantidad
				var local = data.val().local // Obtenemos el dato en la key local
				var img = data.val().img // Obtenemos el dato en la key img

				// Formateamos un li basico para añadir al HTML
				var HTML =  '<li class="prod"><div id='+data.key+'><img src="'+img+'"><h1>'+producto+'</h1><h2>'+local+'</h2><span>'+cantidad+'</span></div></li>'

				// Añadimos el li al HTML en '.productos ul'
				$('.productos ul').append(HTML);
			});

			// Cuando se borra un registro de la base...
			firebase.database().ref('/productos/').on('child_removed', function(data) {
				// Sacamos el li del HTML
				$('#'+data.key).remove();
			});

		})
	</script>
</head>

<body>
	<h1>Listado de productos</h1>
	<!-- div y ul inicialmente vacio donde vamos a ir añadiendo los li ?-->
	<div class="productos">
		<ul>
		</ul>
	</div>
</body>

</html>
